Процедура ПолучитьДанныеЛегенды()
   
	Запрос = Новый Запрос;
	Запрос.Текст = 
		"ВЫБРАТЬ
		|	Приоритеты.ЦветФона КАК ЦветФона,
		|	Приоритеты.ЦветТекста КАК ЦветТекста,
		|	Приоритеты.ВсегоЗадач КАК ВсегоЗадач,
		|	Приоритеты.КоличествоЗадачУКонструктора КАК КоличествоЗадачУКонструктора,
		|	Приоритеты.Наименование КАК Наименование
		|ИЗ
		|	Справочник.Приоритеты КАК Приоритеты
		|
		|УПОРЯДОЧИТЬ ПО
		|	Приоритеты.НомерПоПорядку";
	
	Выборка = Запрос.Выполнить().Выбрать();
	
	Легенда = омHTML.ПолучитьЗаголовокHTML();
	
	Легенда = Легенда + омHTML.ПолучитьHeadHTML("Легенда", -1);
	
	Легенда = Легенда + "<table>";
	Легенда = Легенда + "<tr><td>Приоритет</td><td>Всего задач</td><td>У Конструктора</td></tr>";
	
	ШаблонСтроки = "<tr background-color:""%1""  bgcolor=""%2""><td>%3</td><td>%4</td><td>%5</td></tr>";
	
	Пока Выборка.Следующий() Цикл
		ВебЗначениеЦветаФона = омЦвет.ПолучитьВебПредставленияЦвета(Выборка.ЦветФона, Ложь);
		ВебЗначениеТекстФона = омЦвет.ПолучитьВебПредставленияЦвета(Выборка.ЦветТекста);
		Легенда = Легенда + СтрШаблон(ШаблонСтроки, ВебЗначениеЦветаФона, ВебЗначениеЦветаФона, Выборка.Наименование, Выборка.ВсегоЗадач, Выборка.КоличествоЗадачУКонструктора);	
	КонецЦикла;
	
	Легенда = Легенда + "</table>";
	
	Легенда = Легенда + омHTML.ПолучитьХвостHTML();
	
КонецПроцедуры // ПолучитьДанныеЛегенды()

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	ПолучитьДанныеЛегенды();
КонецПроцедуры
